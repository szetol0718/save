<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Transactions</title>
    <link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">
    <style>
        .summary-box {
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            background-color: #f8f9fa;
            box-shadow: 0 0 5px rgba(0,0,0,0.1);
        }
        .filter-form .form-control, .filter-form .btn {
            margin-right: 10px;
        }
    </style>
</head>
<body>
<div class="container mt-4">
    <h2 class="mb-4">Your Transactions</h2>

    <!-- Summary Section -->
    <div class="row summary-box text-center">
        <div class="col-md-4">
            <h5>Total Income</h5>
            <p class="text-success fw-bold" th:text="${summary.totalIncome}">0.00</p>
        </div>
        <div class="col-md-4">
            <h5>Total Expense</h5>
            <p class="text-danger fw-bold" th:text="${summary.totalExpense}">0.00</p>
        </div>
        <div class="col-md-4">
            <h5>Net Total</h5>
            <p class="fw-bold" th:text="${summary.netTotal}">0.00</p>
        </div>
    </div>

    <!-- Filter Form -->
    <form class="filter-form mb-4 row g-3 align-items-center" th:action="@{/transactions/filter}" method="get">
        <div class="col-md-3">
            <input type="date" name="startDate" class="form-control" th:value="${startDate}">
        </div>
        <div class="col-md-3">
            <input type="date" name="endDate" class="form-control" th:value="${endDate}">
        </div>
        <div class="col-md-2">
            <select name="type" class="form-control">
                <option value="">All Types</option>
                <option value="INCOME">Income</option>
                <option value="EXPENSE">Expense</option>
            </select>
        </div>
        <div class="col-md-2">
            <select name="category" class="form-control" th:each="cat : ${categories}" th:value="${cat}" th:text="${cat}"></select>
        </div>
        <div class="col-md-2">
            <button type="submit" class="btn btn-primary">Filter</button>
            <a th:href="@{/transactions/export}" class="btn btn-success">Export CSV</a>
        </div>
    </form>

    <!-- Transaction Table -->
    <div class="table-responsive">
        <table class="table table-striped table-hover">
            <thead class="table-dark">
            <tr>
                <th>Date</th>
                <th>Description</th>
                <th>Category</th>
                <th>Type</th>
                <th class="text-end">Amount ($)</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="transaction : ${transactions}">
                <td th:text="${transaction.date}"></td>
                <td th:text="${transaction.description}"></td>
                <td th:text="${transaction.category}"></td>
                <td th:text="${transaction.type}"></td>
                <td class="text-end" th:text="${transaction.amount}"></td>
            </tr>
            </tbody>
        </table>
    </div>
</div>

<script th:src="@{/js/bootstrap.bundle.min.js}"></script>
</body>
</html>

